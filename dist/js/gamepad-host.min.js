!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.gamepad=e()}}(function(){return function e(t,n,o){function i(c,s){if(!n[c]){if(!t[c]){var l="function"==typeof require&&require;if(!s&&l)return l(c,!0);if(r)return r(c,!0);var u=new Error("Cannot find module '"+c+"'");throw u.code="MODULE_NOT_FOUND",u}var a=n[c]={exports:{}};t[c][0].call(a.exports,function(e){var n=t[c][1][e];return i(n?n:e)},a,a.exports,e,t,n,o)}return n[c].exports}for(var r="function"==typeof require&&require,c=0;c<o.length;c++)i(o[c]);return i}({1:[function(e,t){!function(n,o){"use strict";function i(e){a=this,e||(e={}),Object.keys(d).forEach(function(t){this[t]=t in e?e[t]:d[t]}.bind(this)),this.listeners={},this.state={}}var r=e("./lib/modal"),c=e("./settings"),s=e("./lib/utils"),l=s.error,u=s.trace;s.polyfill(n);var a,d={protocol:"webrtc"},f={get:function(){return a},init:function(e){return a||new i({protocol:e})}};f.peerHandshake=function(e){return new Promise(function(t){e||(e=s.getPeerId());var o=new Peer(e,{key:c.PEERJS_KEY,debug:c.DEBUG?3:0});n.addEventListener("beforeunload",function(){o.destroy()}),o.on("open",function(){u("My peer ID: "+o.id),t(o)})})},f.peerConnect=function(e){return new Promise(function(t,n){e.on("connection",function(e){e.on("data",function(e){switch(e.type){case"state":f._updateState(e.data);break;default:console.warn('WebRTC message received of unknown type: "'+e.type+'"')}u("Received: "+("object"==typeof e?JSON.stringify(e):""))}),e.on("error",function(e){l(e.message),n(e)}),t(e)})})},f.pair=function(e){return new Promise(function(t){return f.peerHandshake(e).then(function(e){var o=e.id,i=encodeURIComponent(o),c=m+"/client.html?"+i;n.history.replaceState(null,null,n.location.pathname+"?"+i);var l='<div class="modal-inner modal-pair"><h2>URL</h2><p><a href="'+c+'" class="pair-url" target="_blank">'+c+'</a></p><h2>Code</h2><p class="pair-code">'+i+"</p></div>",u=new r({id:"pairing-screen",classes:"slim",title:"Pair your mobile phone",content:l},!0);n.setTimeout(function(){u.open()},150),["https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700","/css/modal.css"].forEach(function(e){s.injectCSS({href:e})}),f.peerConnect(e).then(function(e){console.log("Peer connected"),u.close(),t(e)})}).catch(console.error.bind(console))})},f._updateState=function(e){Object.keys(e||{}).forEach(function(t){!this.state[t]&&e[t]?(f._emit("buttondown",t),f._emit("buttondown."+t,t)):this.state[t]&&!e[t]&&(f._emit("buttonup",t),f._emit("buttonup."+t,t))}.bind(this))},f.hidePairingScreen=function(){r.closeAll()},f._emit=function(e,t){(this.listeners[e]||[]).forEach(function(e){e.apply(e,[t])})},f._bind=function(e,t){return"undefined"==typeof this.listeners[event]&&(this.listeners[event]=[]),this.listeners[event].push(t),this},i.prototype.unbind=function(e,t){return"undefined"==typeof e?(this.listeners={},void 0):"undefined"==typeof t?(this.listeners[e]=[],void 0):"undefined"==typeof this.listeners[e]?!1:(this.listeners[e].forEach(function(n,o){return n===t?(this.listeners[e].splice(o,1),!0):void 0}),!1)},f.buttons={a:{clicked:f._bind}},f.version=c.VERSION;var m=n.location.origin,p=o.querySelector("[data-galaxy-origin]");p&&(f.galaxyOrigin=p.dataset.galaxyOrigin),t.exports=f}(window,document)},{"./lib/modal":2,"./lib/utils":3,"./settings":4}],2:[function(e,t){function n(e,t){Object.keys(e).forEach(function(t){this[t]=e[t]}.bind(this)),t&&this.inject()}var o=e("./utils");n.closeAll=n.prototype.close=function(){var e=document.querySelector(".md-show");e&&e.classList.remove("md-show"),setTimeout(function(){document.body.classList.remove("galaxy-overlayed")},150)},n.injectOverlay=function(){if(!document.querySelector(".md-overlay")){var e=document.createElement("div");e.className="md-overlay",document.body.appendChild(e)}},n.prototype.html=function(){var e=document.createElement("div");return e.id="modal-"+this.id,e.className="md-modal md-effect-1 "+(this.classes||""),e.style.display="none",e.innerHTML='<div class="md-content"><h3>'+o.escape(this.title)+'</h3> <a class="md-close" title="Close"><span><div>Close</div></span></a><div>'+this.content+"</div></div>",e},n.prototype.inject=function(){return n.injectOverlay(),this.el=this.html(),this.el.style.display="block",document.body.appendChild(this.el),document.body.classList.add("galaxy-overlayed"),this.el},n.prototype.open=function(){this.el.classList.add("md-show")},t.exports=n},{"./utils":3}],3:[function(e,t){function n(e,t){console[t||"log"]((window.performance.now()/1e3).toFixed(3)+": "+e)}function o(e){return n(e,"error")}function i(e){return n(e,"warn")}function r(e){"performance"in e||(e.performance={now:function(){return+new Date}}),"origin"in e.location&&(e.location.origin=e.location.protocol+"//"+e.location.host)}function c(){return window.location.pathname.indexOf(".html")?window.location.search.substr(1):window.location.pathname.substr(1)}function s(e){return-1!==h.indexOf(e.target.nodeName.toLowerCase())}function l(){return"ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch}function u(e){var t=document.createElement("link");t.href=e.href,t.media="all",t.rel="stylesheet",t.type="text/css",Object.keys(e||{}).forEach(function(n){t[n]=e[n]}),document.querySelector("head").appendChild(t)}function a(e){return e?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&#34;"):e}function d(){return!(document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement)}function f(){d()?(n("Entering full screen"),document.documentElement.requestFullscreen?document.documentElement.requestFullscreen():document.documentElement.mozRequestFullScreen?document.documentElement.mozRequestFullScreen():document.documentElement.webkitRequestFullscreen?document.documentElement.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT):document.documentElement.msRequestFullscreen&&document.documentElement.msRequestFullscreen()):(n("Exiting full screen"),document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen())}function m(){var e=screen.LockOrientation||screen.mozLockOrientation||screen.webkitLockOrientation||screen.msLockOrientation;return e?(e(orientation),void 0):i("Orientation could not be locked")}function p(e){var t=document.createEvent("HTMLEvents");t.initEvent(e,!0,!0),t.eventName=e,(document.body||window).dispatchEvent(t)}var h=["input","keygen","meter","option","output","progress","select","textarea"];t.exports.trace=n,t.exports.error=o,t.exports.warn=i,t.exports.polyfill=r,t.exports.getPeerId=c,t.exports.fieldFocused=s,t.exports.hasTouchEvents=l,t.exports.injectCSS=u,t.exports.escape=a,t.exports.isFullScreen=d,t.exports.toggleFullScreen=f,t.exports.lockOrientation=m,t.exports.triggerEvent=p},{}],4:[function(e,t){var n={};try{n=e("./settings_local.js")}catch(o){}var i={API_URL:"http://localhost:5000",DEBUG:!1,PEERJS_KEY:"",VERSION:"0.0.1"};for(var r in n)i[r]=n[r];t.exports=i},{"./settings_local.js":5}],5:[function(e,t){t.exports={DEBUG:!0,PEERJS_KEY:"rovu5xmqo69wwmi"}},{}]},{},[1])(1)});